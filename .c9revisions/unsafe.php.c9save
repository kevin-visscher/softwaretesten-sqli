{"ts":1378283128584,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1378283133714,"patch":[[{"diffs":[[1,"<?php\n\n?>"]],"start1":0,"start2":0,"length1":0,"length2":9}]],"length":9,"saved":false}
{"contributors":[],"silentsave":false,"ts":1378283309725,"patch":[[{"diffs":[[0,"<?php\n"],[1,"print 'HVA';"],[0,"\n?>"]],"start1":0,"start2":0,"length1":9,"length2":21}]],"length":21,"saved":false}
{"contributors":[],"silentsave":false,"ts":1380705532690,"patch":[[{"diffs":[[0,"php\n"],[-1,"print 'HVA';\n?"],[1,"    // http://zetcode.com/db/sqlitephp/\n    ini_set('display_errors',1); \n    error_reporting(E_ALL);\n\n    $db = new PDO(\"sqlite:db.sqlite\");\n    \n    $db->exec(file_get_contents(\"create_tables.sql\"));\n    $db->exec(file_get_contents(\"insert.sql\"));\n    \n    if (isset($_POST['username']))\n    {\n        $username = $_POST['username'];\n        $password = $_POST['password'];\n        \n        $statement = $db->query(\n            \"select * \" . \n            \"from users \" . \n            \"where username = '\" . $username . \"' \" .\n            \"and password = '\" . $password . \"'\"\n        );\n        \n        $user = $statement->fetch();\n    }\n  \n    if (isset($_GET['myname']))\n    {\n        $myname = $_GET['myname'];\n    }\n    \n    if (isset($_POST['message']))\n    {\n        $message = $_POST['message'];\n        \n        $db->exec(\"INSERT INTO messages (message) VALUES ('$message')\");\n    }\n    \n    // Retrieve messages\n    $messagesStatement = $db->query('SELECT * FROM messages');\n    $messages = $messagesStatement->fetchAll();\n    \n?>\n\n<!doctype>\n<body>\n    <h1>Unsafe</h1>\n    <?php\n        \n        if (isset($user))\n        {\n            if ($user)\n            {\n                echo \"<p>You're now logged in.\";\n            }\n            else\n            {\n                echo '<p>Invalid login details.';\n            }\n        }\n        \n        if (isset($myname))\n        {\n            echo '<p>Your name is:', $myname;\n        }\n        \n        if (isset($registered))\n        {\n            echo 'You are now registered. Please login';\n        }\n    ?>\n    \n    <h2>Unsafe login form</h2>\n    <!-- Unsafe login form (SQL Injections) -->\n    <form method=\"post\">\n        <input type=\"text\" name=\"username\" placeholder=\"Username\">\n        <input type=\"password\" name=\"password\" placeholder=\"Password\">\n        <button type=\"submit\">Login</button>\n    </form>\n    \n    <h2>Unsafe form that accepts html</h2>\n    <!-- Unsafe form that accepts HTML chars -->\n    <form method=\"get\">\n        <input type=\"text\" name=\"myname\" placeholder=\"My name\">\n        <button type=\"submit\">Say my name!</button>\n    </form>\n    \n    <h2>Unsafe message form</h2>\n    <!-- XSS vunlerable register form -->\n    <form method=\"post\">\n        <textarea name=\"message\" cols=\"40\" rows=\"40\"></textarea>\n        <button type=\"submit\" style=\"font-size:32px;\">Ja hoor. Plaatst u aub mijn bericht</button>\n    </form>\n    \n    <h2>Messages</h2>\n    <?php foreach ($messages as $m) : ?>\n    <?php echo $m['message']; ?>\n    <hr>\n    <?php endforeach; ?>\n</body"],[0,">"]],"start1":2,"start2":2,"length1":19,"length2":2549}]],"length":2551,"saved":false}
{"ts":1380705561541,"patch":[[{"diffs":[[0,");\n    \n    "],[1,"//"],[0,"$db->exec(fi"]],"start1":145,"start2":145,"length1":24,"length2":26}]],"length":2553,"saved":false}
{"ts":1380705617917,"patch":[[{"diffs":[[0,"\" rows=\""],[-1,"4"],[1,"1"],[0,"0\"></tex"]],"start1":2276,"start2":2276,"length1":17,"length2":17}]],"length":2553,"saved":false}
{"contributors":[],"silentsave":false,"ts":1380706239171,"patch":[[{"diffs":[[0,"   \n    "],[-1,"//"],[0,"$db->exe"]],"start1":149,"start2":149,"length1":18,"length2":16},{"diffs":[[0,"ize:"],[-1,"3"],[0,"2"],[1,"4"],[0,"px;\""]],"start1":2341,"start2":2341,"length1":10,"length2":10}]],"length":2551,"saved":false}
